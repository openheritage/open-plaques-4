<% begin %>
  <% if photo.file_url %><% end %>
<% rescue %>
  <% photo = photo.main_photo %>
<% end %>

<% if photo %>
  <% url = local_assigns[:large] ? photo.file_url : photo.thumbnail_url %>
  <% if url %>
    <% url = url.gsub('http:', 'https:') unless photo.geograph? %>
    <div class="card photo">
      <%= image_tag(url, { class: "card-img img-rounded w-100", rel: "foaf:depiction" }) %>
      <div class="card-info">
        <cite>
          <%= photo.licence.creative_commons? ? "<i class=\"bi bi-badge-cc\"></i>".html_safe : "<i class=\"bi bi-c-circle\"></i>".html_safe if photo.licence %> <a href="<%= photo.url %>"><%= photo.photographer if photo.photographer %> on <%= photo.source %></a>
          <% if photo.licence && !photo.licence.creative_commons? %>
            <%= photo.licence.abbreviation ? photo.licence.abbreviation : photo.licence.name %>
          <% end %>
        </cite>
      </div>
    </div>
  <% end %>
<% end %>
