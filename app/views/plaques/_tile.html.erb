<%# locals: (plaque:) %>

<% begin %>
  <% if plaque.area %><% end %>
<% rescue %>
  <% plaque = plaque.plaque %>
<% end %>
<% photo = plaque.main_photo %>

<div class="col-sm-3 col-lg-3 mb-2" data-aos="fade-up" data-aos-delay="100">
  <%= link_to plaque_path(plaque) do %>
    <div class="card plaque text-center">
      <% if photo&.thumbnail_url %>
        <%= render photo %>
      <% else %>
        <%= image_tag "NoPhotoSqr.png", { class: "card-img-top img-responsive w-100" } %>
        <div class="card-img-overlay">
          <% unless photo&.thumbnail_url %>
            <h7 class="card-title"><%= plaque.inscription.truncate(90) %></h7>
          <% end %>
        </div>
      <% end %>
      <div class="card-info">
        <% if plaque.geolocated? %>
          <i class="bi bi-compass"></i>
        <% else %>
          <i class="bi bi-compass-fill"></i>
        <% end %>
        <% if plaque.personal_connections.any? %>
          <i class="bi bi-file-person"></i>
        <% else %>
          <i class="bi bi-file-person-fill"></i>
        <% end %>
        <% if plaque.attributes.key?("series_id") && plaque.series %>
          <small class="text-muted"><%= plaque.series.name %><%= " ##{plaque.series_ref}" if plaque.series_ref? %></small>
        <% end %>
        <small class="text-muted"><%= plaque.area.name if plaque.area %></small>
      </div>
    </div>
  <% end %>
</div>
